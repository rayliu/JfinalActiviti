<!--_meta 作为公共模版分离出去-->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>JFinalActiviti</title>
  <link rel="stylesheet" type="text/css" href="/theme/layui-v2.2.6/layui/css/layui.css" />
  <style type="text/css">
  .a4{
  width:794px;
  height:1279px;
  padding-left:55px;
  }
  h1{
  text-align: center;
  font-family:"楷体";
  padding-top: 30px;
  padding-bottom: 30px;
  }
  .head{
  height: 10%;
  }
  .head td{
  	border: 1px solid #000000;
  	text-align: center;
  }
  .head .info{
  	width: 20%;
  }
  .head .title{
  	width: 13.33333333333333%;
  }
  table{
  width:680px;
  height:550px;
  border:1px solid #000000;
  margin-left:55px;
  border-collapse:separate;
  }
  .lin td{
  	border-top: 1px solid #000000;
  	border-left: 1px solid #000000;
  	border-right: 1px solid #000000;
  }
  .center td{
  	border-bottom: 1px solid #000000;
  	border-left: 1px solid #000000;
  	border-right: 1px solid #000000;
  }
  .lin{
height: 5%;
  }
  .center{
  height: 5%;
  }
  .first td{
  border-top: 1px solid #000000;
  	border-left: 1px solid #000000;
  	border-right: 1px solid #000000;
  	padding-left: 35px;
  	padding-top: 30px;
  }
  .second td{
  border-left: 1px solid #000000;
  	border-right: 1px solid #000000;
  	padding-left: 35px;
  	padding-bottom: 180px;
  }
  .third .left{
  	border-bottom: 1px solid #000000;
    border-left: 1px solid #000000;
  }
    .third .middle{
  	border-bottom: 1px solid #000000;
  }
    .third .right{
  	border-bottom: 1px solid #000000;
    border-right: 1px solid #000000;
  }

  

 </style>
 
</head>
<body >
<div id="layui-body-print" class="layui-body" style="left: 0px;">
<button type="button" id="printBtn" class="layui-btn" style="margin: 15px;">下载</button>
<section>
<div  class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>
	
<div class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>

<div  class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>

<div class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>

<div class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>

<div class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>分页线</legend>
</fieldset>

<div class="a4">
				<h1>员工请假单</h1>
				<table>
						<tr class="head">
								<td class="title">部门</td>
								<td class="info"></td>
								<td class="title">职务</td>
								<td class="info"></td>
								<td class="title">姓名</td>
								<td class="info"></td>
						</tr>
						<tr class="lin">
								<td colspan="6">请假类别</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;☐休假（或 假）&nbsp;☐公假&nbsp;&nbsp;☐病假&nbsp;&nbsp;☐其他（请说明）&nbsp;&nbsp;☐事假&nbsp;</td>
						<tr class="lin">
								<td colspan="6">请假时间</td>
						</tr>
						<tr class="center">
							<td colspan="6">&emsp;&emsp;&emsp;&emsp;&emsp;自&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;27&nbsp;日&nbsp;15&nbsp;时&nbsp;至&nbsp;&nbsp;2018&nbsp;年&nbsp;4&nbsp;月&nbsp;28&nbsp;日&nbsp;18&nbsp;时总共请假&nbsp;0&nbsp;天&nbsp;3&nbsp;小时&nbsp;&nbsp;</td>
						<tr class="head">
								<td colspan="6"  style="font-weight:bold;">主管部门意见</td>
						</tr>
						<tr class="first">
								<td colspan="6">☐准主管签字</td>
						</tr>
						<tr class="second">
								<td colspan="6">☐不准（请述明理由）</td>
						</tr>
						<tr class="third">
								<td colspan="4" class="left"></td>
								<td class="middle">职位&emsp;</td>
								<td class="right">日期&emsp;</td>
						</tr>						
				</table>
				
</div>
</section>
</div>
</body>
</html>
<script src="https://cdn.bootcss.com/html2canvas/0.5.0-beta4/html2canvas.js"></script>
<script src="https://cdn.bootcss.com/jspdf/1.3.4/jspdf.debug.js"></script>
<script src="/theme/layui-v2.2.6/layui/layui.js"></script>
<script>
		layui.use(['jquery', 'form', 'laydate', 'layedit'], function(){
			var form = layui.form, $=layui.$, laydate=layui.laydate,layedit = layui.layedit;

			$('#printBtn').click(function(){
				$("#layui-body-print").removeClass('layui-body');
				$(".layui-elem-field").hide();
				layer.load(1);
				//此处关闭
				setTimeout(function(){
					layer.closeAll('loading');
					printAction();
					$("#layui-body-print").addClass('layui-body');
					$(".layui-elem-field").show();
				}, 5000);
				
			});

			var printAction = function(){
				
				var target = $("section")[0];
				target.style.background = "#FFFFFF";

				html2canvas(target, {
					onrendered:function(canvas) {
						var contentWidth = canvas.width;
						var contentHeight = canvas.height;

						//一页pdf显示html页面生成的canvas高度;
						var pageHeight = contentWidth / 592.28 * 841.89;
						//未生成pdf的html页面高度
						var leftHeight = contentHeight;
						//页面偏移
						var position = 0;
						//a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
						var imgWidth = 595.28;
						var imgHeight = 592.28/contentWidth * contentHeight;
						
						var pageData = canvas.toDataURL('image/jpeg', 1.0);

						var pdf = new jsPDF('', 'pt', 'a4');

						//有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
						//当内容未超过pdf一页显示的范围，无需分页
						if (leftHeight < pageHeight) {
							
							pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight );
							
						} else {
							while(leftHeight > 0) {
								pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
								leftHeight -= pageHeight;
								position -= 841.89;
								
								//避免添加空白页
								if(leftHeight > 0) {
									pdf.addPage();
								}
								
							}
							
						}
						pdf.save("report.pdf");
					}
				})
			};//end of function
		});
</script>